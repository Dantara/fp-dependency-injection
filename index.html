<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Dependency injection</title>
<meta name="author" content="Nikita Aleshchenko"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="styles/tinkoff.css" id="theme"/>

<link rel="stylesheet" href="styles/extra.css"/>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
<link rel="stylesheet" href="styles/monokai.css"/></head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-background="rgb(255, 221, 45)" data-state="title-slide"><img src="images/logo.svg" id="title-img">
<h2 class="title">Dependency injection</h2>
<h3 class="subtitle">in functional programming</h3>
<h6 class="author">Nikita Aleshchenko</h6>
</section>
<section class="about-slide" data-background-color="#757C8D" style="height: 600px;">
  <div class="block">
    <div id="about-column">
      <img src="images/logo-yel.svg">
      <img id="about-travel-img" src="images/travel.png">
    </div>
    <div id="about-block">
      <img src="images/me.png">

      <p>–ù–∏–∫–∏—Ç–∞ –ê–ª–µ—â–µ–Ω–∫–æ | Haskell —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫</p>

      <div id="about-contacts">
        <div class="about-contacts-line">
          <img src="images/at.svg">
          <p>n.aleshchenko@tinkoff.ru</p>
        </div>
        <div class="about-contacts-line">
          <img src="images/gh.png">
          <p>Dantara</p>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="about-slide">
  <img id="slides-qr" src="images/qr.png">
</section>

<section>
<section id="slide-orgc7ad6b2" data-auto-animate>
<h2 id="orgc7ad6b2">–ú—ã –∫–∞–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ö–æ—Ç–∏–º –ø–∏—Å–∞—Ç—å&#x2026;</h2>
</section>
</section>
<section>
<section id="slide-orgc838945" data-auto-animate>
<h2 id="orgc838945">–ú—ã –∫–∞–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ö–æ—Ç–∏–º –ø–∏—Å–∞—Ç—å&#x2026;</h2>
<ul class="fragment appear">
<li>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π –∫–æ–¥;</li>

</ul>
<ul class="fragment appear">
<li>–†–∞—Å—à–∏—Ä—è–µ–º—ã–π –∫–æ–¥;</li>

</ul>
<ul class="fragment appear">
<li>–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥;</li>

</ul>
<ul class="fragment appear">
<li>–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–π –∫–æ–¥;</li>

</ul>


</section>
</section>
<section>
<section id="slide-org3cd23ca" data-auto-animate>
<h2 id="org3cd23ca">Dependency injection</h2>
</section>
</section>
<section>
<section id="slide-org33ee1f3" data-auto-animate>
<h2 id="org33ee1f3">Dependency injection</h2>
<p>
Dependency Injection (–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π) - —ç—Ç–æ –º–µ—Ç–æ–¥ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –ø—Ä–∏–≤—è–∑–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤–Ω–µ –∑–∞–≤–∏—Å–∏–º–æ–≥–æ –∫–ª–∞—Å—Å–∞.
</p>

</section>
<section id="slide-org6564c33">
<h3 id="org6564c33">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ DI</h3>
<ul class="fragment appear">
<li>Separation of concerns (–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–µ–π);
<ul>
<li>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π –∫–æ–¥;</li>
<li>–†–∞—Å—à–∏—Ä—è–µ–º—ã–π –∫–æ–¥;</li>
<li>–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥;</li>

</ul></li>

</ul>
<ul class="fragment appear">
<li>–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å;</li>

</ul>

</section>
</section>
<section>
<section id="slide-org62f53ab" data-auto-animate data-auto-animate-duration="0" data-auto-animate-unmatched="false">
<h2 id="org62f53ab">Onion architecture</h2>
<span class="first-circle circle"></span>
<span class="second-circle circle"></span>
<span class="third-circle circle"></span>

</section>
</section>
<section>
<section id="slide-orgfca0ed8" data-auto-animate data-auto-animate-duration="0" data-auto-animate-unmatched="false">
<h2 id="orgfca0ed8">Onion architecture</h2>
<span class="first-circle circle"></span>
<span class="second-circle circle"></span>
<span class="third-circle circle green-border"></span>

</section>
</section>
<section>
<section id="slide-org53a2149" data-auto-animate data-auto-animate-duration="0" data-auto-animate-unmatched="false">
<h2 id="org53a2149">Onion architecture</h2>
<span class="first-circle circle red-border"></span>
<span class="second-circle circle"></span>
<span class="third-circle circle"></span>

</section>
<section id="slide-org0b4652d">
<h3 id="org0b4652d">–¢—Ä–µ—Ö —Å–ª–æ–π–Ω—ã–π –ø–∏—Ä–æ–≥</h3>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">‚Ññ</th>
<th scope="col" class="org-left">–°–ª–æ–π</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">3</td>
<td class="org-left">–ë–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">DSL –¥–ª—è –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∏</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä</td>
</tr>
</tbody>
</table>




</section>
</section>
<section>
<section id="slide-org32d7336">
<h2 id="org32d7336">–¢–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç</h2>
<div class="outline-text-2" id="text-org32d7336">
</div>
</section>
<section id="slide-orgd451aa3" data-auto-animate>
<h3 id="orgd451aa3">–ë–æ—Ç –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫</h3>
<p>
–ü–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ long polling, –ø–µ—Ä–µ–≤–æ–¥–∏—Ç —Å –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ –Ω–∞ —Ä—É—Å—Å–∫–∏–π, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
</p>

</section>
<section id="slide-org40a318f" data-auto-animate>
<h3 id="org40a318f">–ë–æ—Ç –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫</h3>
<p>
–ü–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ long polling, –ø–µ—Ä–µ–≤–æ–¥–∏—Ç —Å –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ –Ω–∞ —Ä—É—Å—Å–∫–∏–π, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
</p>

<ul>
<li>–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π;</li>
<li>–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π;</li>
<li>–ü–µ—Ä–µ–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞;</li>

</ul>
</section>
<section id="slide-orgd780a47">
<h3 id="orgd780a47">Gist</h3>
<div class="org-src-container">

<pre   ><code class="haskell" data-line-numbers='1-23|1-4|6-7|9-10|12-13|15|16|17|19|20|21-32'>data Message = Msg
  { chatId :: Integer
  , text   :: Text
  }

pullUpdates :: IO [Message]
pullUpdates = ...

sendMessage :: Message -&gt; IO ()
sendMessage = ...

translate :: Text -&gt; IO (Maybe Text)
translate = ...

proceed :: IO ()
proceed = pullUpdates
  &gt;&gt;= traverse_ (translateMsg &gt;=&gt; sendMessage)
  where
    translateMsg :: Message -&gt; IO Message
    translateMsg (Msg ci t) = translate t
      &lt;&amp;&gt; (maybe
             (Msg ci "Cannot translate text")
             (Msg ci))
</code></pre>
</div>

</section>
<section id="slide-orgf65a0d4">
<h3 id="orgf65a0d4">–ü—Ä–æ–±–ª–µ–º—ã</h3>
<ul>
<li>–í–µ—Å—å –∫–æ–¥ –≤ IO; üöÄ</li>
<li>–ù–µ —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã–π –∫–æ–¥;</li>

</ul>


</section>
</section>
<section>
<section id="slide-org37ee196">
<h2 id="org37ee196">Handle / Service pattern</h2>
<div class="outline-text-2" id="text-org37ee196">
</div>
</section>
<section id="slide-org7f46ec5" data-auto-animate>
<h3 id="org7f46ec5">–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
</section>
<section id="slide-orgcfaeffd" data-auto-animate>
<h3 id="orgcfaeffd">–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
<ul>
<li>–§—É–Ω–∫—Ü–∏–∏;</li>
<li>–î–∞–Ω–Ω—ã–µ;</li>

</ul>
</section>
<section id="slide-org6a0abf5">
<h3 id="org6a0abf5">–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è</h3>
<div class="org-src-container">

<pre    data-id="handle0"><code class="haskell" data-trim data-line-numbers>data Handle = Handle
    { hPool   :: Pool Postgres.Connection
    , hCache  :: IORef (PSQueue Int Text User)
    , hLogger :: Logger.Handle  -- Another handle!
    , ...
    }
</code></pre>
</div>
</section>
<section id="slide-org35af477" data-auto-animate>
<h3 id="org35af477">Handle interface</h3>
<div class="org-src-container">

<pre    data-id="handle0"><code class="haskell" data-trim data-line-numbers>data Handle = Handle
    { translate :: Text -&gt; IO (Maybe Text)
    , ...
    }
</code></pre>
</div>

</section>
<section id="slide-org6d4957a" data-auto-animate>
<h3 id="org6d4957a">Handle interface</h3>
<div class="org-src-container">

<pre    data-id="handle0"><code class="haskell" data-trim data-line-numbers='1-7|6-7'>data Handle = Handle
    { translate :: Text -&gt; IO (Maybe Text)
    , ...
    }

translate :: Handle -&gt; Text -&gt; IO (Maybe Text)
translate = ...
</code></pre>
</div>

</section>
<section id="slide-org2412d84" data-auto-animate>
<h3 id="org2412d84">–ù–∞—à –ø—Ä–æ–µ–∫—Ç</h3>
<div class="org-src-container">

<pre    data-id="handle"><code class="haskell" data-line-numbers='1-18|1-8' data-trim>pullUpdates :: IO [Message]
pullUpdates = ...

sendMessage :: IO ()
sendMessage = ...

translate :: Text -&gt; IO (Maybe Text)
translate = ...

proceed :: IO ()
proceed = pullUpdates
  &gt;&gt;= traverse_ (translateMsg &gt;=&gt; sendMessage)
  where
    translateMsg :: Message -&gt; IO Message
    translateMsg (Msg ci t) = translate t
      &lt;&amp;&gt; (maybe
             (Msg ci "Cannot translate text")
             (Msg ci))
</code></pre>
</div>

</section>
<section id="slide-orga7a8e8f" data-auto-animate>
<h3 id="orga7a8e8f">–ù–∞—à –ø—Ä–æ–µ–∫—Ç</h3>
<div class="org-src-container">

<pre    data-id="handle"><code class="haskell" data-line-numbers data-trim>pullUpdates :: IO [Message]
pullUpdates = ...

sendMessage :: Message -&gt; IO ()
sendMessage = ...

translate :: Text -&gt; IO (Maybe Text)
translate = ...
</code></pre>
</div>

</section>
<section id="slide-org773d589" data-auto-animate>
<h3 id="org773d589">–ù–∞—à –ø—Ä–æ–µ–∫—Ç</h3>
<div class="org-src-container">

<pre    data-id="handle"><code class="haskell" data-line-numbers>data Handle = Handle
  { pullUpdates :: IO [Message]
  , sendMessage :: Message -&gt; IO ()
  , translate   :: Text -&gt; IO (Maybe Text)
  }
</code></pre>
</div>

</section>
<section id="slide-org4a3fc66" data-auto-animate>
<h3 id="org4a3fc66">–ù–∞—à –ø—Ä–æ–µ–∫—Ç</h3>
<div class="org-src-container">

<pre    data-id="handle"><code class="haskell" data-line-numbers='1-5|1-16|7-16'>data Handle = Handle
  { pullUpdates :: IO [Message]
  , sendMessage :: Message -&gt; IO ()
  , translate   :: Text -&gt; IO (Maybe Text)
  }

proceed :: Handle -&gt; IO ()
proceed h = pullUpdates h
  &gt;&gt;= traverse_ (translateMsg &gt;=&gt; sendMessage h)
  where
    translateMsg :: Message -&gt; m Message
    translateMsg (Msg ci t) = translate h t
      &lt;&amp;&gt; (maybe
             (Msg ci "Cannot translate text")
             (Msg ci))

</code></pre>
</div>

</section>
<section id="slide-org66a273f" data-auto-animate>
<h3 id="org66a273f">–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑—É–µ–º –º–æ–Ω–∞–¥—É</h3>
<div class="org-src-container">

<pre    data-id="handle2"><code class="haskell" data-line-numbers>data Handle = Handle
  { pullUpdates :: IO [Message]
  , sendMessage :: Message -&gt; IO ()
  , translate   :: Text -&gt; IO (Maybe Text)
  }
</code></pre>
</div>

</section>
<section id="slide-org8d870a8" data-auto-animate>
<h3 id="org8d870a8">–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑—É–µ–º –º–æ–Ω–∞–¥—É</h3>
<div class="org-src-container">

<pre    data-id="handle2"><code class="haskell" data-line-numbers>data Handle m = Handle
  { pullUpdates :: m [Message]
  , sendMessage :: Message -&gt; m ()
  , translate   :: Text -&gt; m (Maybe Text)
  }
</code></pre>
</div>

</section>
<section id="slide-org69d1789" data-auto-animate>
<h3 id="org69d1789">–ù–∞—à –ø—Ä–æ–µ–∫—Ç</h3>
<div class="org-src-container">

<pre    data-id="handle2"><code class="haskell" data-line-numbers='1-16|7'>data Handle m = Handle
  { pullUpdates :: m [Message]
  , sendMessage :: Message -&gt; m ()
  , translate   :: Text -&gt; m (Maybe Text)
  }

proceed :: MonadIO m =&gt; Handle m -&gt; m ()
proceed h = pullUpdates h
  &gt;&gt;= traverse_ (translateMsg &gt;=&gt; sendMessage h)
  where
    translateMsg :: Message -&gt; m Message
    translateMsg (Msg ci t) = translate h t
      &lt;&amp;&gt; (maybe
             (Msg ci "Cannot translate text")
             (Msg ci))

</code></pre>
</div>

</section>
<section id="slide-org8ae652f">
<h3 id="org8ae652f">–ü–ª—é—Å—ã &amp; –º–∏–Ω—É—Å—ã</h3>
</section>
<section id="slide-org06d80b4" data-auto-animate>
<h3 id="org06d80b4">–ü–ª—é—Å—ã:</h3>
</section>
<section id="slide-org8929100" data-auto-animate>
<h3 id="org8929100">–ü–ª—é—Å—ã:</h3>
<ul class="fragment appear">
<li>–ü—Ä–æ—Å—Ç–æ &amp; –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ;</li>

</ul>
<ul class="fragment appear">
<li>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ;</li>

</ul>
<ul class="fragment appear">
<li>–ü–æ–¥–º–µ–Ω–∞ —Ö—ç–Ω–¥–ª–µ—Ä–æ–≤ –≤ —Ä–∞–Ω—Ç–∞–π–º–µ;</li>

</ul>

</section>
<section id="slide-org408dff1" data-auto-animate>
<h3 id="org408dff1">–ú–∏–Ω—É—Å—ã:</h3>
</section>
<section id="slide-org027de23" data-auto-animate>
<h3 id="org027de23">–ú–∏–Ω—É—Å—ã:</h3>
<ul>
<li>–†—É—á–Ω–æ–µ –ø—Ä–æ–∫–∏–¥—ã–≤–∞–Ω–∏–µ —Ö—ç–Ω–¥–ª–µ—Ä–æ–≤;</li>
<li>–ü—Ä–∏–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª–Ω—è—é—â–µ–π –º–æ–Ω–∞–¥–µ;</li>

</ul>


</section>
</section>
<section>
<section id="slide-orgfe3c413" data-auto-animate>
<h2 id="orgfe3c413">Tagless final</h2>
</section>
</section>
<section>
<section id="slide-org94959c2" data-auto-animate>
<h2 id="org94959c2">Tagless final</h2>
<p>
–ü–µ—Ä–µ—Ö–æ–¥ –æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã <b>Handle</b> –∫ <b>Type class</b>&rsquo;–∞–º!
</p>

</section>
<section id="slide-orgdd525d1" data-auto-animate>
<h3 id="orgdd525d1">–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è</h3>
</section>
<section id="slide-org36c5511" data-auto-animate>
<h3 id="org36c5511">–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è</h3>
<div class="org-src-container">

<pre    data-id="tf"><code class="haskell" data-line-numbers>data Handle m = Handle
  { pullUpdates :: m [Message]
  , sendMessage :: Message -&gt; m ()
  , translate   :: Text -&gt; m (Maybe Text)
  }
</code></pre>
</div>

</section>
<section id="slide-orgd5e014b" data-auto-animate>
<h3 id="orgd5e014b">–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è</h3>
<div class="org-src-container">

<pre    data-id="tf"><code class="haskell" data-line-numbers>pullUpdates :: m [Message]
sendMessage :: Message -&gt; m ()
translate   :: Text -&gt; m (Maybe Text)
</code></pre>
</div>

</section>
<section id="slide-orgfbb1181" data-auto-animate>
<h3 id="orgfbb1181">–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è</h3>
<div class="org-src-container">

<pre    data-id="tf"><code class="haskell" data-line-numbers>pullUpdates :: m [Message]
sendMessage :: Message -&gt; m ()

translate   :: Text -&gt; m (Maybe Text)
</code></pre>
</div>

</section>
<section id="slide-org7a0e6fc" data-auto-animate>
<h3 id="org7a0e6fc">–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è</h3>
<div class="org-src-container">

<pre    data-id="tf"><code class="haskell" data-line-numbers>class Monad m =&gt; MonadMessenger m where
  pullUpdates :: m [Message]
  sendMessage :: Message -&gt; m ()

class Monad m =&gt; MonadTranslator m where
  translate :: Text -&gt; m (Maybe Text)
</code></pre>
</div>

</section>
<section id="slide-orgb2b2747" data-auto-animate>
<h3 id="orgb2b2747">–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è</h3>
<p>
–ü–µ—Ä–µ—Ö–æ–¥ –æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã <b>Handle</b> –∫ <b>Type class</b>&rsquo;–∞–º!
</p>
<div class="org-src-container">

<pre    data-id="tf"><code class="haskell" data-line-numbers='1-6|1-3|5-6'>class Monad m =&gt; MonadMessenger m where
  pullUpdates :: m [Message]
  sendMessage :: Message -&gt; m ()

class Monad m =&gt; MonadTranslator m where
  translate :: Text -&gt; m (Maybe Text)
</code></pre>
</div>

</section>
<section id="slide-orgf7ffbe5" data-auto-animate>
<h3 id="orgf7ffbe5">–ù–∞—à –ø—Ä–æ–µ–∫—Ç</h3>
<div class="org-src-container">

<pre    data-id="tf"><code class="haskell" data-line-numbers='1-16|8'>class Monad m =&gt; MonadMessenger m where
  pullUpdates :: m [Message]
  sendMessage :: Message -&gt; m ()

class Monad m =&gt; MonadTranslator m where
  translate :: Text -&gt; m (Maybe Text)

proceed :: (MonadMessenger m, MonadTranslator m) =&gt; m ()
proceed = pullUpdates
  &gt;&gt;= traverse_ (translateMsg &gt;=&gt; sendMessage)
  where
    translateMsg :: (MonadTranslator m) =&gt; Message -&gt; m Message
    translateMsg (Msg ci t) = translate t
      &lt;&amp;&gt; (maybe
             (Msg ci "Cannot translate text")
             (Msg ci))
</code></pre>
</div>

</section>
<section id="slide-orgfc15880" data-auto-animate>
<h3 id="orgfc15880">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</h3>

</section>
<section id="slide-org339f2c0" data-auto-animate>
<h3 id="org339f2c0">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</h3>
<div class="org-src-container">

<pre    data-id="tf-interpret"><code class="haskell" data-trim data-line-numbers>newtype AppM a = AppM { runAppM :: ReaderT SomeContext IO a }
</code></pre>
</div>

</section>
<section id="slide-orgf96796b" data-auto-animate>
<h3 id="orgf96796b">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</h3>
<div class="org-src-container">

<pre    data-id="tf-interpret"><code class="haskell" data-trim data-line-numbers='1-2|2'>newtype AppM a = AppM { runAppM :: ReaderT SomeContext IO a }
  deriving newtype (Functor, Applicative, Monad, ...)
</code></pre>
</div>

</section>
<section id="slide-orgdd0b1e9" data-auto-animate>
<h3 id="orgdd0b1e9">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</h3>
<div class="org-src-container">

<pre    data-id="tf-interpret"><code class="haskell" data-trim data-line-numbers='1-9|4-9'>newtype AppM a = AppM { runAppM :: ReaderT SomeContext IO a }
  deriving newtype (Functor, Applicative, Monad, ...)

instance MonadMessenger AppM where
  pullUpdates = ...
  sendMessage = ...

instance MonadTranslator AppM where
  translate = ...
</code></pre>
</div>

</section>
<section id="slide-org458fc04" data-auto-animate>
<h3 id="org458fc04">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</h3>
<div class="org-src-container">

<pre    data-id="tf-interpret"><code class="haskell" data-trim data-line-numbers='1-15|11-15|11|12|13|15|1,15|14'>newtype AppM a = AppM { runAppM :: ReaderT SomeContext IO a }
  deriving newtype (Functor, Applicative, Monad, ...)

instance MonadMessenger AppM where
  pullUpdates = ...
  sendMessage = ...

instance MonadTranslator AppM where
  translate = ...

interpret :: AppM a -&gt; IO a
interpret app = do
  ctx &lt;- retrieveContext
  flip runReaderT ctx
    $ runAppM app
</code></pre>
</div>

</section>
<section id="slide-org871a0d8">
<h3 id="org871a0d8">–ü–ª—é—Å—ã &amp; –ú–∏–Ω—É—Å—ã</h3>
</section>
<section id="slide-orgefd8ce5" data-auto-animate>
<h3 id="orgefd8ce5">–ü–ª—é—Å—ã</h3>
</section>
<section id="slide-org0a6ed0a" data-auto-animate>
<h3 id="org0a6ed0a">–ü–ª—é—Å—ã</h3>
<ul class="fragment appear">
<li>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å;</li>

</ul>
<ul class="fragment appear">
<li>&ldquo;–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è&rdquo; –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏;</li>

</ul>
<ul class="fragment appear">
<li>–ê–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –º–µ–Ω—å—à–µ –ø—Ä–æ—Ç–µ–∫–∞—é—Ç;</li>

</ul>
</section>
<section id="slide-org6a56831" data-auto-animate>
<h3 id="org6a56831">–ú–∏–Ω—É—Å—ã</h3>
</section>
<section id="slide-orge02ee48" data-auto-animate>
<h3 id="orge02ee48">–ú–∏–Ω—É—Å—ã</h3>
<ul>
<li>–ß–∞—Å—Ç—å –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π –ø—Ä–æ—Ç–µ–∫–∞e—Ç:</li>

</ul>
</section>
<section id="slide-orgb79bbb6" data-auto-animate>
<h3 id="orgb79bbb6">–ú–∏–Ω—É—Å—ã</h3>
<ul>
<li>–ß–∞—Å—Ç—å –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π –ø—Ä–æ—Ç–µ–∫–∞e—Ç:</li>

</ul>
<div class="org-src-container">

<pre    data-id="tf-interpret"><code class="haskell" data-trim>class MonadTranslator m
</code></pre>
</div>
</section>
<section id="slide-orgcbb0af8" data-auto-animate>
<h3 id="orgcbb0af8">–ú–∏–Ω—É—Å—ã</h3>
<ul>
<li>–ß–∞—Å—Ç—å –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π –ø—Ä–æ—Ç–µ–∫–∞e—Ç:</li>

</ul>
<div class="org-src-container">

<pre    data-id="tf-interpret"><code class="haskell" data-trim>class MonadDB m =&gt; MonadTranslator m
</code></pre>
</div>
</section>
<section id="slide-orgf09134f" data-auto-animate>
<h3 id="orgf09134f">–ú–∏–Ω—É—Å—ã</h3>
<ul>
<li>–ß–∞—Å—Ç—å –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π –ø—Ä–æ—Ç–µ–∫–∞e—Ç:</li>

</ul>
<div class="org-src-container">

<pre    data-id="tf-interpret"><code class="haskell" data-trim>class MonadTranslator m

instance MonadDB m =&gt; MonadTranslator m
</code></pre>
</div>
</section>
<section id="slide-orgd797a70" data-auto-animate>
<h3 id="orgd797a70">–ú–∏–Ω—É—Å—ã</h3>
<ul>
<li>–ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞ –Ω–∏–∂–µ –ø–æ —Å—Ç—ç–∫—É:</li>

</ul>
</section>
<section id="slide-orgaef1b1a" data-auto-animate>
<h3 id="orgaef1b1a">–ú–∏–Ω—É—Å—ã</h3>
<ul>
<li>–ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞ –Ω–∏–∂–µ –ø–æ —Å—Ç—ç–∫—É:</li>

</ul>
<div class="org-src-container">

<pre    data-id="tf-interpret"><code class="haskell" data-trim data-line-numbers>newtype AppM a = AppM { runAppM :: ReaderT SomeContext IO a }
  deriving newtype (Functor, Applicative, Monad, ...)

instance MonadMessenger AppM where
  pullUpdates = ...
  sendMessage = ...

instance MonadTranslator AppM where
  translate = ...
</code></pre>
</div>
</section>
<section id="slide-orgc1a3d94" data-auto-animate>
<h3 id="orgc1a3d94">–ú–∏–Ω—É—Å—ã</h3>
<ul>
<li>–ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞ –Ω–∏–∂–µ –ø–æ —Å—Ç—ç–∫—É:</li>

</ul>
<div class="org-src-container">

<pre    data-id="tf-interpret"><code class="haskell" data-trim data-line-numbers='1-9|11-16|13'>newtype AppM a = AppM { runAppM :: ReaderT SomeContext IO a }
  deriving newtype (Functor, Applicative, Monad, ...)

instance MonadMessenger AppM where
  pullUpdates = ...
  sendMessage = ...

instance MonadTranslator AppM where
  translate = ...

instance MonadMessenger m =&gt; MonadMessenger (ReaderT r m) where
  pullUpdates     = ReaderT $ \_ -&gt; pullUpdates
  sendMessage msg = ReaderT $ \_ -&gt; sendMessage msg

instance MonadTranslator m =&gt; MonadTranslator (ReaderT r m) where
  translate t = ReaderT $ \_ -&gt; translate t
</code></pre>
</div>
</section>
<section id="slide-orgb7f50a1" data-auto-animate>
<h3 id="orgb7f50a1">–ú–∏–Ω—É—Å—ã</h3>
<ul>
<li>–ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ &ldquo;—Ä–µ–∏–Ω—Ç—Ä–µ–ø—Ä–µ—Ç–∞—Ü–∏–∏&rdquo; —ç—Ñ—Ñ–µ–∫—Ç–∞:</li>

</ul>
</section>
<section id="slide-org461c47c" data-auto-animate>
<h3 id="org461c47c">–ú–∏–Ω—É—Å—ã</h3>
<ul>
<li>–ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ &ldquo;—Ä–µ–∏–Ω—Ç—Ä–µ–ø—Ä–µ—Ç–∞—Ü–∏–∏&rdquo; —ç—Ñ—Ñ–µ–∫—Ç–∞:</li>

</ul>
<div class="org-src-container">

<pre    data-id="tf-reinterpret"><code class="haskell" data-trim data-line-numbers>newtype AppM a = AppM { runAppM :: ReaderT SomeContext IO a }
  deriving newtype (Functor, Applicative, Monad, ...)

instance MonadMessenger AppM where
  pullUpdates = ...
  sendMessage = ...

instance MonadTranslator AppM where
  translate = ...
</code></pre>
</div>

</section>
<section id="slide-org1da93aa" data-auto-animate>
<h3 id="org1da93aa">–ú–∏–Ω—É—Å—ã</h3>
<ul>
<li>–ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ &ldquo;—Ä–µ–∏–Ω—Ç—Ä–µ–ø—Ä–µ—Ç–∞—Ü–∏–∏&rdquo; —ç—Ñ—Ñ–µ–∫—Ç–∞:</li>

</ul>
<div class="org-src-container">

<pre    data-id="tf-reinterpret"><code class="haskell" data-trim data-line-numbers='1-9|11-19'>newtype AppM a = AppM { runAppM :: ReaderT SomeContext IO a }
  deriving newtype (Functor, Applicative, Monad, ...)

instance MonadMessenger AppM where
  pullUpdates = ...
  sendMessage = ...

instance MonadTranslator AppM where
  translate = ...

newtype AppM2 a = AppM2 { runAppM2 :: ReaderT SomeContext IO a }
  deriving newtype (Functor, Applicative, Monad, ...)

instance MonadMessenger AppM2 where
  pullUpdates = ...
  sendMessage = ...

instance MonadTranslator AppM2 where
  translate = ...
</code></pre>
</div>


</section>
</section>
<section>
<section id="slide-org34f97fa">
<h2 id="org34f97fa">Free monads</h2>
<div class="outline-text-2" id="text-org34f97fa">
</div>
</section>
<section id="slide-org8de4986" data-auto-animate>
<h3 id="org8de4986">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã–µ —è–∑—ã–∫–∏</h3>
</section>
<section id="slide-orgc2f49ba" data-auto-animate>
<h3 id="orgc2f49ba">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã–µ —è–∑—ã–∫–∏</h3>
<ul class="fragment appear">
<li>–ö–æ–¥;</li>

</ul>
<ul class="fragment appear">
<li>AST (Abstract syntax tree);</li>

</ul>
<ul class="fragment appear">
<li>–ò–Ω—Ç—Ä–µ–ø—Ä–µ—Ç–∞—Ç–æ—Ä;</li>

</ul>

</section>
<section id="slide-org0eb659c">
<h3 id="org0eb659c">–ë–æ–ª—å—à–∞—è —Ç—Ä–æ–∏—Ü–∞</h3>
<p>
<b>Functor</b>
</p>
<div class="org-src-container">

<pre   ><code class="haskell" >class Functor f where
  fmap :: (a -&gt; b) -&gt; f a -&gt; f b
</code></pre>
</div>

<p>
<b>Applicative</b>
</p>
<div class="org-src-container">

<pre   ><code class="haskell" >class Functor f =&gt; Applicative f where
  pure :: a -&gt; f a
  (&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b
</code></pre>
</div>

<p>
<b>Monad</b>
</p>
<div class="org-src-container">

<pre   ><code class="haskell" >class Applicative m =&gt; Monad m where
  return :: a -&gt; m a
  (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b
</code></pre>
</div>

</section>
<section id="slide-org9bbb9b0">
<h3 id="org9bbb9b0">Functor</h3>
<div class="org-src-container">

<pre   ><code class="haskell" data-trim data-line-numbers>class Functor f where
  fmap :: (a -&gt; b) -&gt; f a -&gt; f b
</code></pre>
</div>

</section>
<section id="slide-org51e5ccd">
<h3 id="org51e5ccd">Applicative</h3>
<div class="org-src-container">

<pre   ><code class="haskell" data-trim data-line-numbers>class Functor f =&gt; Applicative f where
  pure :: a -&gt; f a
  (&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b
</code></pre>
</div>

</section>
<section id="slide-org1ffd6d8" data-auto-animate>
<h3 id="org1ffd6d8">Monad</h3>
<div class="org-src-container">

<pre    data-id="monad"><code class="haskell" data-trim data-line-numbers>class Applicative m =&gt; Monad m where
  return :: a -&gt; m a
  (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b
</code></pre>
</div>

</section>
<section id="slide-org01b092a" data-auto-animate>
<h3 id="org01b092a">Monad</h3>
<div class="org-src-container">

<pre    data-id="monad"><code class="haskell" data-trim data-line-numbers>class Applicative m =&gt; Monad m where
  return :: a -&gt; m a
  (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b

join :: Monad m =&gt; m (m a) -&gt; m a
</code></pre>
</div>

</section>
<section id="slide-org4ef570c" data-auto-animate>
<h3 id="org4ef570c">Monad</h3>
<div class="org-src-container">

<pre    data-id="monad"><code class="haskell" data-trim data-line-numbers>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
join :: Monad m =&gt; m (m a) -&gt; m a
</code></pre>
</div>

</section>
<section id="slide-org83b262e" data-auto-animate>
<h3 id="org83b262e">Monad</h3>
<div class="org-src-container">

<pre    data-id="monad"><code class="haskell" data-trim data-line-numbers=1-5|4-5>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
join :: Monad m =&gt; m (m a) -&gt; m a

(&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b
(&gt;&gt;=) m f = join (fmap f m)
</code></pre>
</div>

</section>
<section id="slide-org79f238f" data-auto-animate>
<h3 id="org79f238f">–ê–ª–≥–µ–±—Ä–∞ –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∏</h3>
<div class="org-src-container">

<pre    data-id="algebra"><code class="haskell" data-trim data-line-numbers>data Bot
  = PullUpdates [Message]
  | SendMessage Message
  | Translate Text (Maybe Text)
</code></pre>
</div>

</section>
<section id="slide-org3d95ad4" data-auto-animate>
<h3 id="org3d95ad4">–ê–ª–≥–µ–±—Ä–∞ –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∏</h3>
<div class="org-src-container">

<pre    data-id="algebra"><code class="haskell" data-trim data-line-numbers>data Bot
  = PullUpdate Message
  | SendMessage Message
</code></pre>
</div>

</section>
<section id="slide-org2b1b79a" data-auto-animate>
<h3 id="org2b1b79a">–ê–ª–≥–µ–±—Ä–∞ –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∏</h3>
<div class="org-src-container">

<pre    data-id="algebra"><code class="haskell" data-trim data-line-numbers>data Bot next
  = PullUpdate Message next
  | SendMessage Message next
</code></pre>
</div>

</section>
<section id="slide-org0a407c8" data-auto-animate>
<h3 id="org0a407c8">–ê–ª–≥–µ–±—Ä–∞ –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∏</h3>
<div class="org-src-container">

<pre    data-id="algebra"><code class="haskell" data-trim data-line-numbers>data Bot a
  = PullUpdate Message (Bot a)
  | SendMessage Message (Bot a)
</code></pre>
</div>

</section>
<section id="slide-orgc581ef4" data-auto-animate>
<h3 id="orgc581ef4">–ê–ª–≥–µ–±—Ä–∞ –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∏</h3>
<div class="org-src-container">

<pre    data-id="algebra"><code class="haskell" data-trim data-line-numbers>data Bot a
  = PullUpdate Message (Bot a)
  | SendMessage Message (Bot a)
</code></pre>
</div>


<div id="org2746b4e" class="figure">
<p><img src="./images/dolls.png" alt="dolls.png" height="200vh" style="margin-left: 50%; transform: translateX(-50%);" />
</p>
</div>

</section>
<section id="slide-org679c428" data-auto-animate>
<h3 id="org679c428">–ê–ª–≥–µ–±—Ä–∞ –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∏</h3>
<div class="org-src-container">

<pre    data-id="algebra"><code class="haskell" data-trim data-line-numbers>data Bot a
  = PullUpdate (Message -&gt; (Bot a))
  | SendMessage Message (Bot a)
</code></pre>
</div>

</section>
<section id="slide-org27c4fca" data-auto-animate>
<h3 id="org27c4fca">–ê–ª–≥–µ–±—Ä–∞ –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∏</h3>
<div class="org-src-container">

<pre    data-id="algebra"><code class="haskell" data-trim data-line-numbers>data Bot a
  = PullUpdate (Message -&gt; (Bot a))
  | SendMessage Message (Bot a)
  | Done a
</code></pre>
</div>

</section>
<section id="slide-org9d00910" data-auto-animate>
<h3 id="org9d00910">–≠—Ö–æ –±–æ—Ç</h3>
<div class="org-src-container">

<pre    data-id="algebra"><code class="haskell" data-trim data-line-numbers=1-9|6-9|6|7|8|9>data Bot a
  = PullUpdate (Message -&gt; (Bot a))
  | SendMessage Message (Bot a)
  | Done a

echo :: Bot ()
echo = PullUpdate $ \msg -&gt;
       SendMessage msg
     $ Done ()
</code></pre>
</div>
</section>
<section id="slide-org5d38a85" data-auto-animate>
<h3 id="org5d38a85">–≠—Ö–æ –±–æ—Ç</h3>
<div class="org-src-container">

<pre    data-id="algebra"><code class="haskell" data-trim data-line-numbers>data Bot a
  = PullUpdate (Message -&gt; (Bot a))
  | SendMessage Message (Bot a)
  | Done a

echo :: Bot ()
echo = PullUpdate $ \msg -&gt;
       SendMessage msg
     $ Done ()
</code></pre>
</div>


<div id="org5635053" class="figure">
<p><img src="./images/dolls.png" alt="dolls.png" height="200vh" style="margin-left: 50%; transform: translateX(-50%);" />
</p>
</div>

</section>
<section id="slide-org55ed097" data-auto-animate>
<h3 id="org55ed097">Monad instance</h3>
<div class="org-src-container">

<pre    data-id="algebra"><code class="haskell" data-trim data-line-numbers=1-13|6-8|10-13|11|12|13>data Bot a
  = SendMessage Message (Bot a)
  | PullUpdate (Message -&gt; (Bot a))
  | Done a

class Monad m where
  pure  :: m a
  (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b

instance Monad Bot where
  pure = Done
  SendMessage msg k &gt;&gt;= f = SendMessage msg $ k &gt;&gt;= f
  PullUpdate      k &gt;&gt;= f = PullUpdate $ \msg -&gt; k msg &gt;&gt;= f
</code></pre>
</div>

</section>
<section id="slide-org0ffb762" data-auto-animate>
<h3 id="org0ffb762">–≠—Ö–æ –±–æ—Ç</h3>
<div class="org-src-container">

<pre    data-id="algebra"><code class="haskell" data-trim data-line-numbers=1-9|6-9>data Bot a
  = PullUpdate (Message -&gt; (Bot a))
  | SendMessage Message (Bot a)
  | Done a

echo :: Bot ()
echo = do
  msg &lt;- PullUpdate Done
  SendMessage msg $ Done ()
</code></pre>
</div>

</section>
<section id="slide-org3069104" data-auto-animate>
<h3 id="org3069104">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</h3>
<div class="org-src-container">

<pre    data-id="algebra"><code class="haskell" data-trim data-line-numbers=1-13|1-4|6-13|6|7|8-10|11-13>data Bot a
  = Done a
  | SendMessage Message (Bot a)
  | PullUpdate (Message -&gt; (Bot a))

interpretBotIO :: Bot a -&gt; IO a
interpretBotIO (Done a) = pure a
interpretBotIO (SendMessage msg m) = do
  sendMessageIO msg
  interpretBotIO m
interpretBotIO (PullUpdate f) = do
  msg &lt;- pullMessageIO
  interpretBotIO $ f msg
</code></pre>
</div>

</section>
<section id="slide-orgd516665" data-auto-animate>
<h3 id="orgd516665">–ê–±—Å—Ç—Ä–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
<div class="org-src-container">

<pre    data-id="algebra"><code class="haskell" data-trim data-line-numbers>data Bot a
  = SendMessage Message (Bot a)
  | PullUpdate (Message -&gt; (Bot a))
  | Done a
</code></pre>
</div>

</section>
<section id="slide-org9e6e5ce" data-auto-animate>
<h3 id="org9e6e5ce">–ê–±—Å—Ç—Ä–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
<div class="org-src-container">

<pre    data-id="algebra"><code class="haskell" data-trim data-line-numbers>data Bot a
  = SendMessage Message (Bot a)
  | PullUpdate (Message -&gt; (Bot a))
  | Translate Text ((Maybe Text) -&gt; Bot a)
  | Done a
</code></pre>
</div>

</section>
<section id="slide-org79d3955" data-auto-animate>
<h3 id="org79d3955">–ê–±—Å—Ç—Ä–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
<div class="org-src-container">

<pre    data-id="algebra"><code class="haskell" data-trim data-line-numbers=1-10|1-8|10>data BotF next
  = SendMessage Message next
  | PullUpdate (Message -&gt; next)
  | Translate Text ((Maybe Text) -&gt; next)

data Free f a
  = Pure a
  | Impure (f (Free f a))

type Bot a = Free BotF a
</code></pre>
</div>

</section>
<section id="slide-org7700867" data-auto-animate>
<h3 id="org7700867">–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è</h3>
<div class="org-src-container">

<pre    data-id="free"><code class="haskell" data-trim data-line-numbers>data Free f a
  = Pure a
  | Impure (f (Free f a))
</code></pre>
</div>

</section>
<section id="slide-orge41249c" data-auto-animate>
<h3 id="orge41249c">–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è</h3>
<div class="org-src-container">

<pre    data-id="free"><code class="haskell" data-trim data-line-numbers=1-3|5,8|6,9>data Free f a
  = Pure a
  | Impure (f (Free f a))

Pure   :: a -&gt; Free f a             -- looks like pure
Impure :: f (Free f a) -&gt; Free f a  -- looks like join

pure :: Monad m =&gt; a -&gt; m a
join :: Monad m =&gt; m (m a) -&gt; m a
</code></pre>
</div>

</section>
<section id="slide-org0ae1fc1" data-auto-animate>
<h3 id="org0ae1fc1">Functor instance</h3>
<div class="org-src-container">

<pre    data-id="free"><code class="haskell" data-trim data-line-numbers=1-7|5-7>data Free f a
  = Pure a
  | Impure (f (Free f a))

instance Functor f =&gt; Functor (Free f) where
  fmap g (Pure x)    = Pure (g x)
  fmap g (Impure fx) = Impure (fmap g &lt;$&gt; fx)
</code></pre>
</div>

</section>
<section id="slide-org23164a6" data-auto-animate>
<h3 id="org23164a6">Monad instance</h3>
<div class="org-src-container">

<pre    data-id="free"><code class="haskell" data-trim data-line-numbers=1-8|5-8>data Free f a
  = Pure a
  | Impure (f (Free f a))

instance Functor f =&gt; Monad (Free f) where
  pure = Pure
  Pure x    &gt;&gt;= g = g x
  Impure fx &gt;&gt;= g = Impure ((&gt;&gt;= g) &lt;$&gt; fx)
</code></pre>
</div>

</section>
<section id="slide-org656dcf4" data-auto-animate>
<h3 id="org656dcf4">–ê–ª–≥–µ–±—Ä–∞ –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∏</h3>
<div class="org-src-container">

<pre    data-id="free"><code class="haskell" data-trim data-line-numbers>data BotF a
  = PullUpdates ([Message] -&gt; a)
  | SendMessage Message a
  | Translate Text ((Maybe Text) -&gt; a)
  deriving (Functor)

type Bot = Free BotF
</code></pre>
</div>

</section>
<section id="slide-orgd0b25c2" data-auto-animate>
<h3 id="orgd0b25c2">Lift functor</h3>
<div class="org-src-container">

<pre    data-id="free"><code class="haskell" data-trim data-line-numbers>liftF :: Functor f =&gt; f a -&gt; Free f a
liftF command = Free (fmap Pure command)
</code></pre>
</div>

</section>
<section id="slide-orgf70691f" data-auto-animate>
<h3 id="orgf70691f">–•–µ–ª–ø–µ—Ä—ã</h3>
<div class="org-src-container">

<pre    data-id="free"><code class="haskell" data-trim data-line-numbers>data BotF a
  = PullUpdates ([Message] -&gt; a)
  | SendMessage Message a
  | Translate Text ((Maybe Text) -&gt; a)

pullUpdates :: Bot [Message]
pullUpdates = liftF (PullUpdates id)

sendMessage :: Message -&gt; Bot ()
sendMessage msg = liftF (SendMessage msg ())

translate :: Text -&gt; Bot (Maybe Text)
translate t = liftF (Translate t id)
</code></pre>
</div>

</section>
<section id="slide-org47c85d6">
<h3 id="org47c85d6">–ë–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞</h3>
<div class="org-src-container">

<pre   ><code class="haskell" >proceed :: Bot ()
proceed = pullUpdates
  &gt;&gt;= traverse_ (translateMsg &gt;=&gt; sendMessage)
  where
    translateMsg :: Message -&gt; Bot Message
    translateMsg (Msg ci t) = translate t
      &lt;&amp;&gt; (maybe
             (Msg ci "Cannot translate text")
             (Msg ci))
</code></pre>
</div>

</section>
<section id="slide-org3b700ec" data-auto-animate>
<h3 id="org3b700ec">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</h3>
<div class="org-src-container">

<pre    data-id="free"><code class="haskell" data-trim data-line-numbers=1-14|6-9|11-14>data BotF a
  = PullUpdates ([Message] -&gt; a)
  | SendMessage Message a
  | Translate Text ((Maybe Text) -&gt; a)

botIO :: BotF a -&gt; IO a
botIO (PullUpdates u) = ...
botIO (SendMessage m a) = ...
botIO (Translate t ft) = ...

type Bot = Free BotF

interpretBotIO :: Bot a -&gt; IO a
interpretBotIO = ???
</code></pre>
</div>

</section>
<section id="slide-org4879a5f" data-auto-animate>
<h3 id="org4879a5f">–•–µ–ª–ø–µ—Ä—ã</h3>
<div class="org-src-container">

<pre    data-id="free-helpers"><code class="haskell" data-trim data-line-numbers=1-7|2-3|4|5|6|7>freeM
  :: (Functor f, Functor g)
  =&gt; (f a -&gt; g a)
  -&gt; Free f a
  -&gt; Free g a
freeM phi (Pure x)    = Pure x
freeM phi (Impure fx) = Impure $ phi (freeM phi &lt;$&gt; fx)
</code></pre>
</div>

</section>
<section id="slide-org53f1851" data-auto-animate>
<h3 id="org53f1851">–•–µ–ª–ø–µ—Ä—ã</h3>
<div class="org-src-container">

<pre    data-id="free-helpers"><code class="haskell" data-trim data-line-numbers=9-13|9>freeM
  :: (Functor f, Functor g)
  =&gt; (f a -&gt; g a)
  -&gt; Free f a
  -&gt; Free g a
freeM phi (Pure x)    = Pure x
freeM phi (Impure fx) = Impure $ phi (freeM phi &lt;$&gt; fx)

monad :: Monad m =&gt; Free m a -&gt; m a
monad (Pure x) = pure x
monad (Free mfx) = do
  fx &lt;- mfx
  monad fx
</code></pre>
</div>

</section>
<section id="slide-orga517ab7" data-auto-animate>
<h3 id="orga517ab7">–•–µ–ª–ø–µ—Ä—ã</h3>
<div class="org-src-container">

<pre    data-id="free-helpers"><code class="haskell" data-trim data-line-numbers=1-20|15-20>freeM
  :: (Functor f, Functor g)
  =&gt; (f a -&gt; g a)
  -&gt; Free f a
  -&gt; Free g a
freeM phi (Pure x)    = Pure x
freeM phi (Impure fx) = Impure $ phi (freeM phi &lt;$&gt; fx)

monad :: Monad m =&gt; Free m a -&gt; m a
monad (Pure x) = pure x
monad (Free mfx) = do
  fx &lt;- mfx
  monad fx

interpret
  :: (Functor f, Monad m)
  =&gt; (f a -&gt; m a)
  -&gt; Free f a
  -&gt; m a
interpret phi = monad . freeM phi
</code></pre>
</div>

</section>
<section id="slide-orgbe1c5ee" data-auto-animate>
<h3 id="orgbe1c5ee">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</h3>
<div class="org-src-container">

<pre    data-id="free-helpers"><code class="haskell" data-trim data-line-numbers=1-10|1|3-7|9-10>botIO :: BotF a -&gt; IO a

interpret
  :: (Functor f, Monad m)
  =&gt; (f a -&gt; m a)
  -&gt; Free f a
  -&gt; m a

interpetBotIO :: Bot a -&gt; IO a
interpetBotIO = interpret botIO
</code></pre>
</div>

</section>
<section id="slide-orgea5ce75" data-auto-animate>
<h3 id="orgea5ce75">–ö–æ–º–ø–æ–∑–∏—Ü–∏—è –∞–ª–≥–µ–±—Ä</h3>
<div class="org-src-container">

<pre    data-id="free-comp"><code class="haskell" data-trim data-line-numbers>data BotF a
  = PullUpdates ([Message] -&gt; a)
  | SendMessage Message a
  | Translate Text ((Maybe Text) -&gt; a)

type Bot = Free BotF
</code></pre>
</div>

</section>
<section id="slide-org3e11d26" data-auto-animate>
<h3 id="org3e11d26">–ö–æ–º–ø–æ–∑–∏—Ü–∏—è –∞–ª–≥–µ–±—Ä</h3>
<div class="org-src-container">

<pre    data-id="free-comp"><code class="haskell" data-trim data-line-numbers>data MessengerF a
  = PullUpdates ([Message] -&gt; a)
  | SendMessage Message a

data TranslatorF a
  = Translate Text ((Maybe Text) -&gt; a)
</code></pre>
</div>

</section>
<section id="slide-orgfb3229b" data-auto-animate>
<h3 id="orgfb3229b">–¢–∏–ø —Å—É–º–º—ã</h3>
<div class="org-src-container">

<pre    data-id="free-comp"><code class="haskell" data-trim data-line-numbers>data Sum f g a
  = L (f a)
  | R (g a)

instance (Functor f, Functor g) =&gt; Functor (Sum f g)
</code></pre>
</div>

</section>
<section id="slide-orgf6b8966" data-auto-animate>
<h3 id="orgf6b8966">–ö–æ–º–ø–æ–∑–∏—Ü–∏—è –∞–ª–≥–µ–±—Ä</h3>
<div class="org-src-container">

<pre    data-id="free-comp"><code class="haskell" data-trim data-line-numbers=1-10|10>data MessengerF a
  = PullUpdates ([Message] -&gt; a)
  | SendMessage Message a
  deriving (Functor)

data TranslatorF a
  = Translate Text ((Maybe Text) -&gt; a)
  deriving (Functor)

type BotF = Sum MessengerF TranslatorF
</code></pre>
</div>

</section>
<section id="slide-org34f7add" data-auto-animate>
<h3 id="org34f7add">–•–µ–ª–ø–µ—Ä—ã</h3>
<div class="org-src-container">

<pre    data-id="free-comp"><code class="haskell" data-trim data-line-numbers>pullUpdates :: Bot [Message]
pullUpdates = liftF $ PullUpdates id

sendMessage :: Message -&gt; Bot ()
sendMessage msg = liftF $ SendMessage msg ()

translate :: Text -&gt; Bot (Maybe Text)
translate t = liftF $ Translate t id
</code></pre>
</div>

</section>
<section id="slide-org01be8ec" data-auto-animate>
<h3 id="org01be8ec">–•–µ–ª–ø–µ—Ä—ã</h3>
<div class="org-src-container">

<pre    data-id="free-comp"><code class="haskell" data-trim data-line-numbers>pullUpdates :: Bot [Message]
pullUpdates = liftF $ L $ PullUpdates id

sendMessage :: Message -&gt; Bot ()
sendMessage msg = liftF $ L $ SendMessage msg ()

translate :: Text -&gt; Bot (Maybe Text)
translate t = liftF $ R $ Translate t id
</code></pre>
</div>

</section>
<section id="slide-org0c027a8">
<h3 id="org0c027a8">–¢–∏–ø —Å—É–º–º—ã</h3>
<div class="org-src-container">

<pre   ><code class="haskell" data-trim data-line-numbers>data Sum f g a
  = L (f a)
  | R (g a)
</code></pre>
</div>

</section>
<section id="slide-org53e4d7f" data-auto-animate>
<h3 id="org53e4d7f">–í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è</h3>
</section>
<section id="slide-org21944d0" data-auto-animate>
<h3 id="org21944d0">–í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è</h3>
<ul>
<li>–ü–æ—Å—Ç–æ—Ä–æ–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞ (Hierarchical Free Monads);</li>
<li>–†–∞—Å—à–∏—Ä—è–µ–º—ã–π —Å–ø–∏c–æ–∫ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ (Extensible effects);</li>

</ul>

</section>
<section id="slide-org459f8ce" data-auto-animate>
<h3 id="org459f8ce">Hierarchical Free Monads</h3>
<div class="org-src-container">

<pre    data-id="hfm"><code class="haskell" data-trim data-line-numbers>data MessengerF next
  = PullUpdates ([Message] -&gt; next)
  | SendMessage Message next

data TranslatorF next
  = Translate Text ((Maybe Text) -&gt; next)
</code></pre>
</div>

</section>
<section id="slide-org8871eac" data-auto-animate>
<h3 id="org8871eac">Hierarchical Free Monads</h3>
<div class="org-src-container">

<pre    data-id="hfm"><code class="haskell" data-trim data-line-numbers=1-10|8-10>data MessengerF next
  = PullUpdates ([Message] -&gt; next)
  | SendMessage Message next

data TranslatorF next
  = Translate Text ((Maybe Text) -&gt; next)

data BotF a
  = EvalMessenger  (MessengerF a)
  | EvalTranslator (TranslatorF a)
</code></pre>
</div>

</section>
<section id="slide-org30a8222" data-auto-animate>
<h3 id="org30a8222">Hierarchical Free Monads</h3>
<div class="org-src-container">

<pre    data-id="hfm"><code class="haskell" data-trim data-line-numbers>data BotF a
  = EvalMessenger  (MessengerF a)
  | EvalTranslator (TranslatorF a)
  | EvalLogger     (LoggerF a)
</code></pre>
</div>

</section>
<section id="slide-org4a1aa81" data-auto-animate>
<h3 id="org4a1aa81">Hierarchical Free Monads</h3>
<div class="org-src-container">

<pre    data-id="hfm"><code class="haskell" data-trim data-line-numbers>data BotF a
  = EvalMessenger  (MessengerF a)
  | EvalTranslator (TranslatorF a)
  | EvalLogger     (LoggerF a)

botIO :: BotF a -&gt; IO a
botIO (EvalMessenger m)  = messengerIO m
botIO (EvalTranslator m) = translatorIO m
botIO (EvalLogger m)     = evalLoggerIO m
</code></pre>
</div>


</section>
<section id="slide-orgb8c0e14">
<h3 id="orgb8c0e14">–ü–ª—é—Å—ã &amp; –ú–∏–Ω—É—Å—ã</h3>

</section>
<section id="slide-orgd96bc4e" data-auto-animate>
<h3 id="orgd96bc4e">–ü–ª—é—Å—ã:</h3>
</section>
<section id="slide-orga3afd7a" data-auto-animate>
<h3 id="orga3afd7a">–ü–ª—é—Å—ã:</h3>
<ul>
<li>–í—ã—Å–æ–∫–∞—è –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å;</li>
<li>–ß–∏—Å—Ç–æ—Ç–∞ –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∏;</li>
<li>–ñ–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ–µ–≤ (–ø—Ä–∏ HFM);</li>

</ul>

</section>
<section id="slide-org9551250" data-auto-animate>
<h3 id="org9551250">–ú–∏–Ω—É—Å—ã:</h3>
</section>
<section id="slide-org06d6cd2" data-auto-animate>
<h3 id="org06d6cd2">–ú–∏–Ω—É—Å—ã:</h3>
<ul>
<li>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–ø—Ä–∏ initial –∫–æ–¥–∏—Ä–æ–≤–∫–µ);</li>
<li>Boilerplate;</li>
<li>–≠—Ñ—Ñ–µ–∫—Ç—ã –≤—ã—Å—à–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞;</li>

</ul>

</section>
<section id="slide-org0cf82fc">
<h3 id="org0cf82fc">–≠—Ñ—Ñ–µ–∫—Ç—ã –≤—ã—Å—à–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞</h3>

</section>
<section id="slide-orgb890655" data-auto-animate>
<h3 id="orgb890655">–§—É–Ω–∫—Ü–∏–∏ –≤—ã—Å—à–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞</h3>
<div class="org-src-container">

<pre   ><code class="haskell" data-trim data-line-numbers>map :: (a -&gt; b) -&gt; [a] -&gt; [b]

filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]
</code></pre>
</div>

</section>
<section id="slide-org251a88c" data-auto-animate>
<h3 id="org251a88c">–≠—Ñ—Ñ–µ–∫—Ç—ã –≤—ã—Å—à–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞</h3>
<div class="org-src-container">

<pre    data-id="hfm"><code class="haskell" data-trim data-line-numbers=1-3|3>class MonadReader r m | m -&gt; r where
  ask   :: m r
  local :: (r -&gt; r) -&gt; m a -&gt; ma
</code></pre>
</div>

</section>
<section id="slide-org4976017" data-auto-animate>
<h3 id="org4976017">–≠—Ñ—Ñ–µ–∫—Ç—ã –≤—ã—Å—à–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞</h3>
<div class="org-src-container">

<pre    data-id="hfm"><code class="haskell" data-trim data-line-numbers=1-3|3>class MonadError e m | m -&gt; e where
  throwError :: e -&gt; m a
  catchError :: m a -&gt; (e -&gt; m a) -&gt; m a
</code></pre>
</div>

</section>
</section>
<section>
<section id="slide-orgf16bd8d">
<h2 id="orgf16bd8d">Freer monads</h2>
<div class="outline-text-2" id="text-orgf16bd8d">
</div>
</section>
<section id="slide-org3b39fca" data-auto-animate>
<h3 id="org3b39fca">Generilized Algebraic Data Types (GADT)</h3>
</section>
<section id="slide-org5181d60" data-auto-animate>
<h3 id="org5181d60">Generilized Algebraic Data Types (GADT)</h3>
<div class="org-src-container">

<pre    data-id="gadt"><code class="haskell" data-line-numbers>data SomeType a
  = First a
  | Second a
</code></pre>
</div>

</section>
<section id="slide-org5731245" data-auto-animate>
<h3 id="org5731245">Generilized Algebraic Data Types (GADT)</h3>
<div class="org-src-container">

<pre    data-id="gadt"><code class="haskell" data-line-numbers>data SomeType a where
  First  :: a -&gt; SomeType a
  Second :: a -&gt; SomeType a
</code></pre>
</div>

</section>
<section id="slide-org05211a0" data-auto-animate>
<h3 id="org05211a0">Generilized Algebraic Data Types (GADT)</h3>
<div class="org-src-container">

<pre    data-id="gadt"><code class="haskell" data-line-numbers>data SomeType a where
  First  :: a -&gt; SomeType a
  Second :: Int -&gt; SomeType Int
</code></pre>
</div>

</section>
<section id="slide-orgfde09f4" data-auto-animate>
<h3 id="orgfde09f4">Generilized Algebraic Data Types (GADT)</h3>
<div class="org-src-container">

<pre    data-id="gadt"><code class="haskell" data-line-numbers>data SomeType a where
  First  :: b -&gt; SomeType b
  Second :: Int -&gt; SomeType Int
</code></pre>
</div>

</section>
<section id="slide-orgb24a4a6" data-auto-animate>
<h3 id="orgb24a4a6">Free monad</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>data Free f a
  = Pure a
  | Impure (f (Free f a))
</code></pre>
</div>
</section>
<section id="slide-org71156d7" data-auto-animate>
<h3 id="org71156d7">Free monad</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>data Free f a where
  Pure   :: a -&gt; Free f a
  Impure :: f (Free f a) -&gt; Free f a
</code></pre>
</div>

</section>
<section id="slide-org7d56401" data-auto-animate>
<h3 id="org7d56401">–ü—Ä–æ—Å—Ç–æ–π —Ç—Ä—é–∫</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers=1-2|4-5|7-8>data Lan g a where
  Lan :: g x -&gt; (x -&gt; a) -&gt; Lan g a

instance Functor (Lan g) where
  fmap f (Lan gx h) = Lan gx (f . h)

lan :: g a -&gt; Lan g a
lan ga = Lan ga id
</code></pre>
</div>

</section>
<section id="slide-org5b7ffee" data-auto-animate>
<h3 id="org5b7ffee">–ü—Ä–æ—Å—Ç–æ–π —Ç—Ä—é–∫</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers=1-5|2,5>data Lan g b where
  Lan :: (a -&gt; b) -&gt; g a -&gt; Lan g b

class Functor f where
  fmap :: (a -&gt; b) -&gt; f a -&gt; f b
</code></pre>
</div>

</section>
<section id="slide-org803c38c" data-auto-animate>
<h3 id="org803c38c">–ü—Ä–æ—Å—Ç–æ–π —Ç—Ä—é–∫</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers data-trim data-line-numbers='1-14|1-5|8-14'>data Lan g b where
  Lan :: (a -&gt; b) -&gt; g a -&gt; Lan g b

class Functor f where
  fmap :: (a -&gt; b) -&gt; f a -&gt; f b


data FFree g a where
  FPure   :: a -&gt; FFree g a
  FImpure :: g x -&gt; (x -&gt; FFree g a) -&gt; FFree g a

class Monad m where
  pure  :: a -&gt; m a
  (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b
</code></pre>
</div>

</section>
<section id="slide-orge8b74dc" data-auto-animate>
<h3 id="orge8b74dc">–ü—Ä–æ—Å—Ç–æ–π —Ç—Ä—é–∫</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>data FFree g a where
  FPure   :: a -&gt; FFree g a
  FImpure :: g x -&gt; (x -&gt; FFree g a) -&gt; FFree g a

class Monad m where
  pure  :: a -&gt; m a
  (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b
</code></pre>
</div>

</section>
<section id="slide-orgfaa0ad7" data-auto-animate>
<h3 id="orgfaa0ad7">–ü—Ä–æ—Å—Ç–æ–π —Ç—Ä—é–∫</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers=1-9|1>FFree g = Free (Lan g)

data FFree g a where
  FPure   :: a -&gt; FFree g a
  FImpure :: g x -&gt; (x -&gt; FFree g a) -&gt; FFree g a

class Monad m where
  pure  :: a -&gt; m a
  (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b
</code></pre>
</div>


</section>
<section id="slide-orga39faa3">
<h3 id="orga39faa3">–ê–ª–≥–µ–±—Ä–∞ –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∏</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>data Bot a where
  PullUpdates :: Bot [Message]
  SendMessage :: Message -&gt; Bot ()
  Translate   :: Text -&gt; Bot (Maybe Text)

type BotM = FFree Bot
</code></pre>
</div>

</section>
<section id="slide-org189c163" data-auto-animate>
<h3 id="org189c163">Lift helper</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>lan :: g a -&gt; Lan g a
lan ga = Lan ga id

send :: g a -&gt; FFree g a
send fa = FImpure fa FPure
</code></pre>
</div>

</section>
<section id="slide-org952c424" data-auto-animate>
<h3 id="org952c424">–•–µ–ª–ø–µ—Ä—ã</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers=1-18|11-18>data Bot a where
  PullUpdates :: Bot [Message]
  SendMessage :: Message -&gt; Bot ()
  Translate   :: Text -&gt; Bot (Maybe Text)

type BotM = FFree Bot

send :: g a -&gt; FFree g a
send fa = FImpure fa FPure

pullUpdates :: BotM [Message]
pullUpdates = send PullUpdates

sendMessage :: Message -&gt; BotM [Message]
sendMessage = send . SendMessage

translate :: Text -&gt; BotM (Maybe Text)
translate :: send . Translate
</code></pre>
</div>

</section>
<section id="slide-orgdf0f2e2">
<h3 id="orgdf0f2e2">–ë–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>proceed :: Bot ()
proceed = pullUpdates
  &gt;&gt;= traverse_ (translateMsg &gt;&gt;= sendMessage)
  where
    translateMsg :: Message -&gt; Bot Message
    translateMsg (Msg ci t) = translate t
      &lt;&amp;&gt; (maybe
             (Msg ci "Cannot translate text")
             (Msg ci))
</code></pre>
</div>

</section>
<section id="slide-org3d9a269">
<h3 id="org3d9a269">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>data Bot a where
  PullUpdates :: Bot [Message]
  SendMessage :: Message -&gt; Bot ()
  Translate   :: Text -&gt; Bot (Maybe Text)

botIO :: Bot a -&gt; IO a
botIO PullUpdates       = ...
botIO (SendMessage msg) = ...
botIO (Translate t)     = ...
</code></pre>
</div>

</section>
<section id="slide-org9193c03">
<h3 id="org9193c03">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>data FFree g a where
  FPure   :: a -&gt; FFree g a
  FImpure :: g x -&gt; (x -&gt; FFree g a) -&gt; FFree g a

runFree
  :: Monad m
  =&gt; (f a -&gt; m a)
  -&gt; FFree f a
  -&gt; m a
runFree phi m = loop m
  where
    loop (FPure x)     = pure x
    loop (FImpure u q) = phi u $ loop q
</code></pre>
</div>

</section>
<section id="slide-org5b68e38">
<h3 id="org5b68e38">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>runFree
  :: Monad m
  =&gt; (f a -&gt; m a)
  -&gt; FFree f a
  -&gt; m a

botIO :: Bot a -&gt; IO a

interpretBotIO :: FFree Bot a -&gt; IO a
interpretBotIO = runFree botIO
</code></pre>
</div>

</section>
<section id="slide-orgb1692ea" data-auto-animate>
<h3 id="orgb1692ea">–ü–ª—é—Å—ã:</h3>
</section>
<section id="slide-org3258d51" data-auto-animate>
<h3 id="org3258d51">–ü–ª—é—Å—ã:</h3>
<ul>
<li>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å;</li>
<li>–õ–∞–∫–æ–Ω–∏—á–Ω–æ—Å—Ç—å;</li>

</ul>

</section>
<section id="slide-orgf39496a" data-auto-animate>
<h3 id="orgf39496a">–õ–∞–∫–æ–Ω–∏—á–Ω–æ—Å—Ç—å</h3>
<p>
<b>Free</b>
</p>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>data BotF a
  = PullUpdates ([Message] -&gt; a)
  | SendMessage Message a
  | Translate Text ((Maybe Text) -&gt; a)
</code></pre>
</div>

</section>
<section id="slide-org4ef63ba" data-auto-animate>
<h3 id="org4ef63ba">–õ–∞–∫–æ–Ω–∏—á–Ω–æ—Å—Ç—å</h3>
<p>
<b>Free</b>
</p>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>data BotF a
  = PullUpdates ([Message] -&gt; a)
  | SendMessage Message a
  | Translate Text ((Maybe Text) -&gt; a)
</code></pre>
</div>

<p>
<b>Freer</b>
</p>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>data Bot a where
  PullUpdates :: Bot [Message]
  SendMessage :: Message -&gt; Bot ()
  Translate   :: Text -&gt; Bot (Maybe Text)
</code></pre>
</div>

</section>
<section id="slide-orgfa54c14" data-auto-animate>
<h3 id="orgfa54c14">–õ–∞–∫–æ–Ω–∏—á–Ω–æ—Å—Ç—å</h3>
<p>
<b>Free</b>
</p>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>pullUpdates :: Bot [Message]
pullUpdates = liftF $ PullUpdates id

sendMessage :: Message -&gt; Bot ()
sendMessage msg = liftF $ SendMessage msg ()

translate :: Text -&gt; Bot (Maybe Text)
translate t = liftF $ Translate t id
</code></pre>
</div>

</section>
<section id="slide-org1d03310" data-auto-animate>
<h3 id="org1d03310">–õ–∞–∫–æ–Ω–∏—á–Ω–æ—Å—Ç—å</h3>
<p>
<b>Free</b>
</p>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>pullUpdates :: Bot [Message]
pullUpdates = liftF $ PullUpdates id

sendMessage :: Message -&gt; Bot ()
sendMessage msg = liftF $ SendMessage msg ()

translate :: Text -&gt; Bot (Maybe Text)
translate t = liftF $ Translate t id
</code></pre>
</div>

<p>
<b>Freer</b>
</p>
<div class="org-src-container">

<pre   ><code class="haskell" >pullUpdates :: BotM [Message]
pullUpdates = send PullUpdates

sendMessage :: Message -&gt; BotM [Message]
sendMessage = send . SendMessage

translate :: Text -&gt; BotM (Maybe Text)
translate :: send . Translate
</code></pre>
</div>

</section>
</section>
<section>
<section id="slide-org956f0f7">
<h2 id="org956f0f7">Effects systems</h2>
<div class="outline-text-2" id="text-org956f0f7">
</div>
</section>
<section id="slide-orgdbf34cb" data-auto-animate>
<h3 id="orgdbf34cb">Freer monad</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>data FFree g a where
  FPure   :: a -&gt; FFree g a
  FImpure :: g x -&gt; (x -&gt; FFree g a) -&gt; FFree g a
</code></pre>
</div>

</section>
<section id="slide-org0b34056" data-auto-animate>
<h3 id="org0b34056">–ê–ª–≥–µ–±—Ä–∞ –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∏</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>data Bot a where
  PullUpdates :: Bot [Message]
  SendMessage :: Message -&gt; Bot ()
  Translate   :: Text -&gt; Bot (Maybe Text)
</code></pre>
</div>

</section>
<section id="slide-orga3e9825" data-auto-animate>
<h3 id="orga3e9825">–ê–ª–≥–µ–±—Ä–∞ –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∏</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>data Messenger a where
  PullUpdates :: Messenger [Message]
  SendMessage :: Message -&gt; Messenger ()

data Translator a where
  Translate   :: Text -&gt; Translator (Maybe Text)
</code></pre>
</div>

</section>
<section id="slide-org9f770e5">
<h3 id="org9f770e5">–¢–∏–ø —Å—É–º–º—ã</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>data Sum f g a
  = L (f a)
  | R (g a)
</code></pre>
</div>

</section>
<section id="slide-org9160d19">
<h3 id="org9160d19">–í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è</h3>
<ul>
<li>–ü–æ—Å—Ç–æ—Ä–æ–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞ (Hierarchical Free Monads);</li>
<li>–†–∞—Å—à–∏—Ä—è–µ–º—ã–π —Å–ø–∏c–æ–∫ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ (Extensible effects);</li>

</ul>

</section>
<section id="slide-org591edf2" data-auto-animate>
<h3 id="org591edf2">Union type</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>data Union (sig :: [Type -&gt; Type]) r
</code></pre>
</div>

</section>
<section id="slide-org5fb71f4" data-auto-animate>
<h3 id="org5fb71f4">Union type</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>data Union (sig :: [Type -&gt; Type]) r

Union '[Messenger, Translator]
</code></pre>
</div>

</section>
<section id="slide-orgc228055" data-auto-animate>
<h3 id="orgc228055">Member class</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers=1-7|3-5|7>data Union (sig :: [Type -&gt; Type]) r

class Member f r where
  inj :: f a -&gt; Union r a
  prj :: Union r a -&gt; Maybe (f a)

decomp :: Union (f ': r) a -&gt; Either (Union r a) (f a)
</code></pre>
</div>

</section>
<section id="slide-org19b9117" data-auto-animate>
<h3 id="org19b9117">Freer monad</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>data FFree f a where
  FPure   :: a -&gt; FFree f a
  FImpure :: f x -&gt; (x -&gt; FFree f a) -&gt; FFree f a
</code></pre>
</div>

</section>
<section id="slide-orgf2a1fdc" data-auto-animate>
<h3 id="orgf2a1fdc">Freer monad</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers=1-8|5-8>data FFree f a where
  FPure   :: a -&gt; FFree f a
  FImpure :: f x -&gt; (x -&gt; FFree f a) -&gt; FFree f a


data FEFree r a where
  FEPure   :: a -&gt; FEFree r a
  FEImpure :: Union r x -&gt; (x -&gt; FEFree f a) -&gt; FEFree r a
</code></pre>
</div>

</section>
<section id="slide-orga36f9b8" data-auto-animate>
<h3 id="orga36f9b8">Lift helper</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers=1-12|7-12|11-12>data Union (sig :: [Type -&gt; Type]) r

class Member f r where
  inj :: f a -&gt; Union r a
  prj :: Union r a -&gt; Maybe (f a)

data Eff r a where
  Pure   :: a -&gt; Eff r a
  Impure :: Union r x -&gt; (x -&gt; Eff r a) -&gt; Eff r a

send :: Member f r =&gt; f a -&gt; Eff r a
send fa = Impure (inj fa) Pure
</code></pre>
</div>

</section>
<section id="slide-org6afdec9" data-auto-animate>
<h3 id="org6afdec9">–•e–ª–ø–µ—Ä—ã</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>send :: Member f r =&gt; f a -&gt; Eff r a
send fa = Impure (inj fa) Pure

pullUpdates
  :: Member Messager r
  =&gt; Eff r [Message]
pullUpdates = send PullUpdates

sendMessage
  :: Member Messager r
  =&gt; Message
  -&gt; Eff r [Message]
sendMessage = send . SendMessage

translate
  :: Member Transaltor r
  =&gt; Text
  -&gt; Eff r (Maybe Text)
translate = send . Translate
</code></pre>
</div>

</section>
<section id="slide-orge854a19">
<h3 id="orge854a19">–ë–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>proceed :: (Member Messenger r, Member Translator r) =&gt; Eff r ()
proceed = pullUpdates
  &gt;&gt;= traverse_ (translateMsg &gt;&gt;= sendMessage)
  where
    translateMsg :: Member Messenger r =&gt; Message -&gt; Eff r Message
    translateMsg (Msg ci t) = translate t
      &lt;&amp;&gt; (maybe
             (Msg ci "Cannot translate text")
             (Msg ci))
</code></pre>
</div>

</section>
<section id="slide-org358d976">
<h3 id="org358d976">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å TF</h3>
<p>
<b>Effect system</b>
</p>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>proceed :: (Member Messenger r, Member Translator r) =&gt; Eff r ()
</code></pre>
</div>

<p>
<b>Tagless final</b>
</p>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>proceed :: (MonadMessenger m, MonadTranslator m) =&gt; m ()
</code></pre>
</div>

</section>
<section id="slide-orga707dfc" data-auto-animate>
<h3 id="orga707dfc">–ë–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers=1-9|2-3>proceed :: (Member Messenger r, Member Translator r) =&gt; Eff r ()
proceed = pullUpdates
  &gt;&gt;= traverse_ (translateMsg &gt;=&gt; sendMessage)
  where
    translateMsg :: Member Messenger r =&gt; Message -&gt; Eff r Message
    translateMsg (Msg ci t) = translate t
      &lt;&amp;&gt; (maybe
             (Msg ci "Cannot translate text")
             (Msg ci))
</code></pre>
</div>

</section>
<section id="slide-org70fa48c" data-auto-animate>
<h3 id="org70fa48c">–ë–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers=2-4>proceed :: (Member Messenger r, Member Translator r) =&gt; Eff r ()
proceed = do
  updates &lt;- pullUpdates
  traverse_ (translateMsg &gt;=&gt; sendMessage) updates
  where
    translateMsg :: Member Messenger r =&gt; Message -&gt; Eff r Message
    translateMsg (Msg ci t) = translate t
      &lt;&amp;&gt; (maybe
             (Msg ci "Cannot translate text")
             (Msg ci))
</code></pre>
</div>

</section>
<section id="slide-orgd82b6f8" data-auto-animate>
<h3 id="orgd82b6f8">–ë–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers=2-5,8-10>proceed :: (Member Messenger r, Member Translator r) =&gt; Eff r ()
proceed = do
  updates &lt;- pullUpdates
  runReader ctx
   $ traverse_ (translateMsg &gt;=&gt; sendMessage) updates
  where
    translateMsg
      :: ( Member Messenger r
         , Member (Reader ctx) r )
      =&gt; Message -&gt; Eff r Message
    translateMsg (Msg ci t) = translate t
      &lt;&amp;&gt; (maybe
             (Msg ci "Cannot translate text")
             (Msg ci))
</code></pre>
</div>

</section>
<section id="slide-orgd5240d7" data-auto-animate>
<h3 id="orgd5240d7">–ë–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers=2-6,9-12>proceed :: (Member Messenger r, Member Translator r) =&gt; Eff r ()
proceed = do
  updates &lt;- pullUpdates
  runReader ctx
   $ runRandom
   $ traverse_ (translateMsg &gt;=&gt; sendMessage) updates
  where
    translateMsg
      :: ( Member Messenger r
         , Member Random r
         , Member (Reader ctx) r )
      =&gt; Message -&gt; Eff r Message
    translateMsg (Msg ci t) = translate t
      &lt;&amp;&gt; (maybe
             (Msg ci "Cannot translate text")
             (Msg ci))
</code></pre>
</div>

</section>
<section id="slide-orge7ac6b0">
<h3 id="orge7ac6b0">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers>decomp :: Union (f ': r) a -&gt; Either (Union r a) (f a)

interpret
  :: (eff a -&gt; Eff effs)
  -&gt; Eff (eff ': effs)
  -&gt; Eff effs
interpret _   (Pure a)     = Pure a
interpret phi (Impure u f) = case decomp u of
  Right fa -&gt; phi fa
  Left u'  -&gt; Impure u' $ \x -&gt; interpret phi (f x)
</code></pre>
</div>

</section>
<section id="slide-org7afd1a8">
<h3 id="org7afd1a8">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</h3>
<div class="org-src-container">

<pre    data-id="freer"><code class="haskell" data-line-numbers=1-8|1-4|6|8>reinterpret
  :: (f a -&gt; Eff (g ': effs))
  -&gt; Eff (f ': effs)
  -&gt; Eff (g ': effs)

runM :: Monad m =&gt; Eff '[m] a -&gt; m a

run :: Eff '[] a -&gt; a
</code></pre>
</div>

</section>
<section id="slide-org96d9334">
<h3 id="org96d9334">Effects system libraries</h3>
<ul>
<li>freer-simple</li>
<li>polysemy</li>
<li>fused-effects</li>
<li>&#x2026;</li>

</ul>

</section>
<section id="slide-org00ef986">
<h3 id="org00ef986">–ü–ª—é—Å—ã &amp; –º–∏–Ω—É—Å—ã</h3>
</section>
<section id="slide-orga1e627e" data-auto-animate>
<h3 id="orga1e627e">–ü–ª—é—Å—ã</h3>
</section>
<section id="slide-org84fa97e" data-auto-animate>
<h3 id="org84fa97e">–ü–ª—é—Å—ã</h3>
<ul>
<li>–í—ã—Å–æ–∫–∞—è –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ—Ç—å:
<ul>
<li>–†–µ–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —ç—Ñ—Ñ–µ–∫—Ç–æ–≤;</li>
<li>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –Ω–∞ –ª–µ—Ç—É;</li>
<li>–ü—Ä–æ—Å—Ç–∞—è –ø–æ–¥–º–µ–Ω–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–æ–≤;</li>
<li>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –≤—ã—Å—à–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞;</li>

</ul></li>
<li>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å;</li>

</ul>
</section>
<section id="slide-orgc40fd5d" data-auto-animate>
<h3 id="orgc40fd5d">–ú–∏–Ω—É—Å—ã</h3>
</section>
<section id="slide-org0db3b8b" data-auto-animate>
<h3 id="org0db3b8b">–ú–∏–Ω—É—Å—ã</h3>
<ul>
<li>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å;</li>
<li>–í—ã—Å–æ–∫–∏–π –ø–æ—Ä–æ–≥ –≤—Ö–æ–¥–∞;</li>

</ul>

</section>
</section>
<section>
<section id="slide-org119f17f">
<h2 id="org119f17f">–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–Ω–∏–º–∞–Ω–∏–µ!</h2>
</section>
</section>
<section>
<section id="slide-org7b6cf3b">
<h2 id="org7b6cf3b">Questions?</h2>

</section>
</section>
<section>
<section id="slide-org4379345">
<h2 id="org4379345">Appendix</h2>

</section>
</section>
<section>
<section id="slide-orgc94c052" data-auto-animate>
<h2 id="orgc94c052">Type class</h2>
</section>
<section id="slide-org8be0371" data-auto-animate>
<h3 id="org8be0371">Type class</h3>
<p>
<b>Type class</b> ‚âà <b>Interface</b>
</p>

</section>
<section id="slide-org7258150" data-auto-animate>
<h3 id="org7258150">Type class</h3>
<p>
<b>Type class</b> ‚âà <b>Interface</b>
</p>

<div class="org-src-container">

<pre    data-id="type-class"><code class="haskell" data-trim data-line-numbers='1-3|1|2|3'>data Bool
  = True
  | False
</code></pre>
</div>

</section>
<section id="slide-org8d9e4e3" data-auto-animate>
<h3 id="org8d9e4e3">Type class</h3>
<p>
<b>Type class</b> ‚âà <b>Interface</b>
</p>

<div class="org-src-container">

<pre    data-id="type-class"><code class="haskell" data-trim data-line-numbers='1-6|5-6|5|6'>data Bool
  = True
  | False

class Show a where
  show :: a -&gt; String
</code></pre>
</div>

</section>
<section id="slide-org4c95d5a" data-auto-animate>
<h3 id="org4c95d5a">Type class</h3>
<p>
<b>Type class</b> ‚âà <b>Interface</b>
</p>

<div class="org-src-container">

<pre    data-id="type-class"><code class="haskell" data-trim data-line-numbers='1-10|8-10|8|9-10'>data Bool
  = True
  | False

class Show a where
  show :: a -&gt; String

instance Show Bool where
  show True  = "True"
  show False = "False"
</code></pre>
</div>

</section>
<section id="slide-orgb591541">
<h3 id="orgb591541">–§—É–Ω–∫—Ü–∏–∏ –≤—ã—Å—à–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞</h3>
<div class="org-src-container">

<pre    data-id="tf"><code class="haskell" >map :: (a -&gt; b) -&gt; [a] -&gt; [b]
</code></pre>
</div>

</section>
<section id="slide-org4a52d8c" data-auto-animate>
<h3 id="org4a52d8c">–¢–∏–ø—ã –≤—ã—Å—à–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞</h3>
<div class="org-src-container">

<pre    data-id="type-class2"><code class="haskell" >class Functor f where
  fmap :: (a -&gt; b) -&gt; f a -&gt; f b
</code></pre>
</div>

</section>
<section id="slide-org3870185" data-auto-animate>
<h3 id="org3870185">–¢–∏–ø—ã –≤—ã—Å—à–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞</h3>
<div class="org-src-container">

<pre    data-id="type-class2"><code class="haskell" data-line-numbers='1-2|1'>class Functor (f :: Type -&gt; Type) where
  fmap :: (a -&gt; b) -&gt; f a -&gt; f b
</code></pre>
</div>

</section>
<section id="slide-org91e40d5" data-auto-animate>
<h3 id="org91e40d5">–¢–∏–ø—ã –≤—ã—Å—à–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞</h3>
<div class="org-src-container">

<pre    data-id="type-class2"><code class="haskell" data-line-numbers='1-6|4-6'>class Functor f where
  fmap :: (a -&gt; b) -&gt; f a -&gt; f b

instance Functor Maybe where
  fmap f (Just a) = Just $ f a
  fmap _ Nothing  = Nothing
</code></pre>
</div>
</section>
</section>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/dist/reveal.js"></script>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/plugin/highlight/highlight.js"></script>


<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
plugins: [RevealHighlight],
width:1075, navigationMode:"linear"
});

</script>
</body>
</html>
